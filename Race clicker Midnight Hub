-- Platoboost Configuration
local service = 829  -- Replace with your actual service ID
local secret = "022a2c62-bbaf-44bf-bf4a-33d712f830e7"  -- Replace with your actual secret
local useNonce = true

-- Message Callback
local onMessage = function(message)
    game:GetService("StarterGui"):SetCore("SendNotification", {
        Title = "Key System",
        Text = message,
        Duration = 5
    })
end

-- Load Key System Libraries
loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Orion/main/source"))()

-- Key System Check
local function checkKey()
    local success = verifyKey(_G.Key)
    if not success then
        onMessage("Invalid key! Please get a valid key to use this script.")
        return false
    end
    return true
end

-- Main Script
local function loadMainScript()
    local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/shlexware/Orion/main/source"))()
    local Window = OrionLib:MakeWindow({Name = "Race Clicker", HidePremium = false, SaveConfig = true, ConfigFolder = "RaceClicker"})

    -- Variables
    getgenv().A = false
    getgenv().B = false
    getgenv().H = false
    getgenv().R = false
    local E = nil

    -- Utility Functions
    function TPCFrame(Player_CFrame)
        if game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = Player_CFrame
        end
    end

    function A()
        spawn(function()
            while getgenv().A do
                game:GetService("ReplicatedStorage").Packages.Knit.Services.ClickService.RF.Click:InvokeServer()
                TPCFrame(CFrame.new(-442300, 26, 13))
                task.wait()
                TPCFrame(CFrame.new(-442100, 26, 13))
                if not getgenv().A then break end
                task.wait()
            end
        end)
    end

    function B()
        spawn(function()
            while getgenv().B do
                game:GetService("ReplicatedStorage").Packages.Knit.Services.PetsService.RF.EquipBest:InvokeServer()
                task.wait(1)
            end
        end)
    end

    function H()
        spawn(function()
            while getgenv().H do
                local args = {[1] = E, [2] = "1", [3] = {}}
                game:GetService("ReplicatedStorage").Packages.Knit.Services.EggService.RF.Open:InvokeServer(unpack(args))
                task.wait()
            end
        end)
    end

    function R()
        spawn(function()
            while getgenv().R do
                game:GetService("ReplicatedStorage").Packages.Knit.Services.RebirthService.RF.Rebirth:InvokeServer()
                task.wait()
            end
        end)
    end

    -- Key System Tab
    local KeyTab = Window:MakeTab({
        Name = "Key System",
        Icon = "rbxassetid://4483345998",
        PremiumOnly = false
    })

    KeyTab:AddButton({
        Name = "Get Key",
        Callback = function()
            copyLink()
            setclipboard(cachedLink)
            onMessage("Key link copied to clipboard!")
        end
    })

    KeyTab:AddTextbox({
        Name = "Enter Key",
        Default = "",
        TextDisappear = true,
        Callback = function(value)
            _G.Key = value
            if checkKey() then
                onMessage("Key validated successfully!")
            end
        end
    })

    -- Main Tab
    local MainTab = Window:MakeTab({
        Name = "Main",
        Icon = "rbxassetid://4483345998",
        PremiumOnly = false
    })

    MainTab:AddToggle({
        Name = "Inf. Wins/Inf. Speed",
        Default = false,
        Callback = function(value)
            if not checkKey() then return end
            getgenv().A = value
            if value then A() end
        end
    })

    MainTab:AddToggle({
        Name = "Inf. Rebirths",
        Default = false,
        Callback = function(value)
            if not checkKey() then return end
            getgenv().R = value
            if value then R() end
        end
    })

    MainTab:AddToggle({
        Name = "Equip Best",
        Default = false,
        Callback = function(value)
            if not checkKey() then return end
            getgenv().B = value
            if value then B() end
        end
    })

    MainTab:AddToggle({
        Name = "Hatch",
        Default = false,
        Callback = function(value)
            if not checkKey() then return end
            getgenv().H = value
            if value then H() end
        end
    })

    MainTab:AddDropdown({
        Name = "Select Egg",
        Default = "Starter01",
        Options = {"Starter01", "Starter02", "Starter03", "Starter04", "Pro01", "Pro02", "Pro03"},
        Callback = function(value)
            if not checkKey() then return end
            E = value
        end
    })

    -- [Rest of the original tabs and functionality remain the same...]

    -- Initialize
    OrionLib:Init()
end

-- Initial Key Check and Script Load
if checkKey() then
    loadMainScript()
else
    onMessage("Please enter a valid key to use this script!")
    -- Create minimal UI for key entry
    local KeyWindow = OrionLib:MakeWindow({Name = "Key System", HidePremium = true, SaveConfig = false})
    local KeyTab = KeyWindow:MakeTab({Name = "Key", Icon = "rbxassetid://4483345998"})
    
    KeyTab:AddButton({
        Name = "Get Key",
        Callback = function()
            copyLink()
            setclipboard(cachedLink)
            onMessage("Key link copied to clipboard!")
        end
    })

    KeyTab:AddTextbox({
        Name = "Enter Key",
        Default = "",
        TextDisappear = true,
        Callback = function(value)
            _G.Key = value
            if checkKey() then
                KeyWindow:Destroy()
                loadMainScript()
            end
        end
    })
end
