-- Load Key System UI
local Rayfield = loadstring(game:HttpGet('https://raw.githubusercontent.com/shlexware/Rayfield/main/source'))()

-- Create Key System Window
local Window = Rayfield:CreateWindow({
    Name = "Midnight Hub Key System",
    LoadingTitle = "Midnight Hub",
    LoadingSubtitle = "by Midnight Team",
    ConfigurationSaving = {
        Enabled = false,
        FolderName = nil,
        FileName = nil
    },
    KeySystem = true,
    KeySettings = {
        Title = "Midnight Hub | Key System",
        Subtitle = "Key Required",
        Note = "Join our Discord for key (discord.gg/yourdiscordhere)",
        FileName = "MidnightKey",
        SaveKey = false,
        GrabKeyFromSite = false,
        Key = {"MidnightHub2024", "PremiumUser123", "TestKey456"}
    }
})

-- Main Script (will only run after correct key)
function loadMainScript()
    if game.PlaceId ~= 9285238704 then return end
    Rayfield:Destroy() -- Destroy key system UI
    
    local OrionLib = loadstring(game:HttpGet(('https://raw.githubusercontent.com/shlexware/Orion/main/source')))()
    local Window = OrionLib:MakeWindow({Name = "Race Clicker", HidePremium = false, SaveConfig = true})
    
    -- Variables
    local plr = game.Players.LocalPlayer
    local char = plr.Character or plr.CharacterAdded:Wait()
    
    -- Main Tab
    local MainTab = Window:MakeTab({
        Name = "Main",
        Icon = "rbxassetid://4483345998",
        PremiumOnly = false
    })

    -- Utility Functions
    function TPCFrame(Player_CFrame)
        if game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
            game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = Player_CFrame
        end
    end

    -- Auto Click
    MainTab:AddToggle({
        Name = "Auto Click",
        Default = false,
        Callback = function(Value)
            getgenv().AutoClick = Value
            while getgenv().AutoClick and task.wait() do
                game:GetService("ReplicatedStorage"):WaitForChild("Packages"):WaitForChild("Knit"):WaitForChild("Services"):WaitForChild("ClickService"):WaitForChild("RF"):WaitForChild("Click"):InvokeServer()
            end
        end
    })

    -- Auto Rebirth
    MainTab:AddToggle({
        Name = "Auto Rebirth",
        Default = false,
        Callback = function(Value)
            getgenv().AutoRebirth = Value
            while getgenv().AutoRebirth and task.wait() do
                game:GetService("ReplicatedStorage"):WaitForChild("Packages"):WaitForChild("Knit"):WaitForChild("Services"):WaitForChild("RebirthService"):WaitForChild("RF"):WaitForChild("Rebirth"):InvokeServer()
            end
        end
    })

    -- Auto Race
    MainTab:AddToggle({
        Name = "Auto Race",
        Default = false,
        Callback = function(Value)
            getgenv().AutoRace = Value
            while getgenv().AutoRace and task.wait() do
                TPCFrame(CFrame.new(-442300, 26, 13))
                task.wait(0.1)
                TPCFrame(CFrame.new(-442100, 26, 13))
            end
        end
    })

    -- Eggs Tab
    local EggsTab = Window:MakeTab({
        Name = "Eggs",
        Icon = "rbxassetid://4483345998",
        PremiumOnly = false
    })

    -- Egg Selection
    local selectedEgg = "Starter01"
    EggsTab:AddDropdown({
        Name = "Select Egg",
        Default = "Starter01",
        Options = {"Starter01", "Starter02", "Starter03", "Starter04", "Pro01", "Pro02", "Pro03"},
        Callback = function(Value)
            selectedEgg = Value
        end
    })

    -- Auto Hatch
    EggsTab:AddToggle({
        Name = "Auto Hatch",
        Default = false,
        Callback = function(Value)
            getgenv().AutoHatch = Value
            while getgenv().AutoHatch and task.wait() do
                local args = {
                    [1] = selectedEgg,
                    [2] = "1",
                    [3] = {}
                }
                game:GetService("ReplicatedStorage"):WaitForChild("Packages"):WaitForChild("Knit"):WaitForChild("Services"):WaitForChild("EggService"):WaitForChild("RF"):WaitForChild("Open"):InvokeServer(unpack(args))
            end
        end
    })

    -- Auto Equip Best
    EggsTab:AddToggle({
        Name = "Auto Equip Best",
        Default = false,
        Callback = function(Value)
            getgenv().AutoEquip = Value
            while getgenv().AutoEquip and task.wait(1) do
                game:GetService("ReplicatedStorage"):WaitForChild("Packages"):WaitForChild("Knit"):WaitForChild("Services"):WaitForChild("PetsService"):WaitForChild("RF"):WaitForChild("EquipBest"):InvokeServer()
            end
        end
    })

    -- Player Tab
    local PlayerTab = Window:MakeTab({
        Name = "LocalPlayer",
        Icon = "rbxassetid://4483345998",
        PremiumOnly = false
    })

    -- WalkSpeed Slider
    PlayerTab:AddSlider({
        Name = "WalkSpeed",
        Min = 16,
        Max = 500,
        Default = 16,
        Color = Color3.fromRGB(255,255,255),
        Increment = 1,
        ValueName = "Speed",
        Callback = function(Value)
            if char and char:FindFirstChild("Humanoid") then
                char.Humanoid.WalkSpeed = Value
            end
        end    
    })

    -- JumpPower Slider
    PlayerTab:AddSlider({
        Name = "JumpPower",
        Min = 50,
        Max = 500,
        Default = 50,
        Color = Color3.fromRGB(255,255,255),
        Increment = 1,
        ValueName = "Power",
        Callback = function(Value)
            if char and char:FindFirstChild("Humanoid") then
                char.Humanoid.JumpPower = Value
            end
        end    
    })

    -- FOV Slider
    PlayerTab:AddSlider({
        Name = "FOV",
        Min = 70,
        Max = 120,
        Default = 70,
        Color = Color3.fromRGB(255,255,255),
        Increment = 1,
        ValueName = "FOV",
        Callback = function(Value)
            game.Workspace.CurrentCamera.FieldOfView = Value
        end    
    })

    -- Utility Buttons
    PlayerTab:AddButton({
        Name = "Rejoin Server",
        Callback = function()
            game:GetService("TeleportService"):Teleport(game.PlaceId, plr)
        end    
    })

    PlayerTab:AddButton({
        Name = "Reset Character",
        Callback = function()
            if char then char:BreakJoints() end
        end    
    })

    PlayerTab:AddButton({
        Name = "Destroy GUI",
        Callback = function()
            OrionLib:Destroy()
        end    
    })

    -- Credits Tab
    local CreditsTab = Window:MakeTab({
        Name = "Credits",
        Icon = "rbxassetid://4483345998",
        PremiumOnly = false
    })

    CreditsTab:AddLabel("Made by Midnight Hub")
    
    OrionLib:Init()
end

-- Load main script after key verification
loadMainScript()
